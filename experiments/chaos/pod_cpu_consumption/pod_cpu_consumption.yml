    - name: Get CPU Request by the pod 
      shell: kubectl get po -n {{ app_ns }}  -l {{app_lkey}}="{{app_lvalue}}" -o jsonpath="{.items[0].spec.containers[0].resources.requests.cpu}"
      register: cpu_request

    - set_fact:
        cpur: "{{ cpu_request.stdout.split('m')[0]}}"

    - block:  

        - name: Cordoning the node
          shell: kubectl cordon {{ node_name }}

        - name: Deleting the Application 
          shell: kubectl delete po {{ pod_name }} -n {{ app_ns }}

        - name: Uncordoning the node
          shell: kubectl uncordon {{ node_name }}

        - name: Getting status of application
          shell: kubectl get pod -n {{ app_ns }}  -o=custom-columns=NAME:.status.phase --no-headers 
          register: results
          until: results.stdout == 'Running'
          delay: 25
          retries: 15
  
        - name: Getting the new nodename
          shell: kubectl get po -n {{ app_ns }} -o=custom-columns=NODE:.spec.nodeName --no-headers
          register: new_node
 
      when: cpur | int > {{ cpu_input }}
